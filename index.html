<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>South Park Digital Pet</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

    body {
        font-family: 'Arial Black', Arial, sans-serif;
        background: linear-gradient(to bottom, #87CEEB, #90EE90);
        min-height: 100vh;
        padding: 20px;
    }

    .container {
        max-width: 800px;
        margin: 0 auto;
    }

    #selectScreen {
        text-align: center;
    }

    h1 {
        font-size: 48px;
        color: white;
        text-shadow: 4px 4px 0 #000;
        margin-bottom: 20px;
    }

    .subtitle {
        font-size: 24px;
        color: white;
        font-weight: bold;
        margin-bottom: 30px;
    }

    .char-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        margin-bottom: 30px;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
    }

    .char-card {
        background: white;
        border: 4px solid black;
        padding: 20px;
        cursor: pointer;
        transition: all 0.3s;
    }

    .char-card:hover {
        background: #ffffcc;
        transform: scale(1.05);
    }

    .char-name {
        font-size: 20px;
        margin-top: 15px;
        font-weight: bold;
    }

    .char-img {
        width: 120px;
        height: 120px;
        margin: 0 auto;
        object-fit: contain;
    }

    .btn {
        padding: 15px 30px;
        font-size: 18px;
        font-weight: bold;
        border: 4px solid #000;
        cursor: pointer;
        transition: all 0.3s;
    }

    .btn:hover {
        transform: scale(1.05);
    }

    .load-btn {
        background: #4169E1;
        color: white;
    }

    #gameScreen {
        display: none;
        background: white;
        border: 8px solid #000;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }

    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
    }

    .header h2 {
        font-size: 32px;
    }

    .header-btns {
        display: flex;
        gap: 10px;
    }

    .save-btn {
        background: #28a745;
        color: white;
        padding: 10px 20px;
        font-size: 16px;
        border: 4px solid #000;
        font-weight: bold;
        cursor: pointer;
    }

    .exit-btn {
        background: #dc3545;
        color: white;
        padding: 10px 20px;
        font-size: 16px;
        border: 4px solid #000;
        font-weight: bold;
        cursor: pointer;
    }

    .pet-display {
        background: linear-gradient(to bottom, #ADD8E6, #90EE90);
        border: 4px solid #000;
        padding: 60px;
        margin-bottom: 30px;
        min-height: 300px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .pet-sprite {
        width: 200px;
        height: 200px;
        object-fit: contain;
        transition: transform 0.3s;
    }

    .pet-sprite.animate {
        animation: bounce 0.5s;
    }

    @keyframes bounce {
        0%, 100% { transform: translateY(0) scale(1); }
        50% { transform: translateY(-20px) scale(1.1); }
    }

    .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
    }

    .stat {
        border: 4px solid #000;
        padding: 15px;
        background: #f0f0f0;
    }

    .stat-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 10px;
        font-weight: bold;
        font-size: 16px;
    }

    .stat-bar {
        width: 100%;
        height: 30px;
        background: #ccc;
        border: 2px solid #000;
        position: relative;
        overflow: hidden;
    }

    .stat-fill {
        height: 100%;
        transition: width 0.5s;
    }

    .stat-fill.high { background: #28a745; }
    .stat-fill.medium { background: #ffc107; }
    .stat-fill.low { background: #dc3545; }

    .stat-value {
        text-align: right;
        font-weight: bold;
        margin-top: 5px;
    }

    .age-display {
        text-align: center;
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 30px;
    }

    .actions {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
    }

    .action-btn {
        padding: 20px;
        border: 4px solid #000;
        font-weight: bold;
        font-size: 16px;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        transition: all 0.3s;
    }

    .action-btn:hover {
        transform: translateY(-5px);
    }

    .action-btn.feed { background: #ffd700; }
    .action-btn.play { background: #ff69b4; }
    .action-btn.clean { background: #87ceeb; }
    .action-btn.sleep { background: #9370db; }

    .icon {
        font-size: 32px;
    }

    input[type="file"] {
        display: none;
    }
</style>
</head>
<body>
    <div class="container">
        <div id="selectScreen">
            <h1>SOUTH PARK PETS</h1>
            <p class="subtitle">Pick your buddy!</p>
        <div class="char-grid">
            <div class="char-card" onclick="selectCharacter('stan', 'Stan', '1.png')">
                <img src="1.png" class="char-img" alt="Stan">
                <div class="char-name">Stan</div>
            </div>

            <div class="char-card" onclick="selectCharacter('kyle', 'Kyle', '2.png')">
                <img src="2.png" class="char-img" alt="Kyle">
                <div class="char-name">Kyle</div>
            </div>

            <div class="char-card" onclick="selectCharacter('cartman', 'Cartman', '3.png')">
                <img src="3.png" class="char-img" alt="Cartman">
                <div class="char-name">Cartman</div>
            </div>

            <div class="char-card" onclick="selectCharacter('kenny', 'Kenny', '4.png')">
                <img src="4.png" class="char-img" alt="Kenny">
                <div class="char-name">Kenny</div>
            </div>
        </div>

        <button class="btn load-btn" onclick="document.getElementById('fileInput').click()">
            üìÅ Load Save (.sps)
        </button>
        <input type="file" id="fileInput" accept=".sps" onchange="loadFromFile(event)">
    </div>

    <div id="gameScreen">
        <div class="header">
            <h2 id="petName">Stan's Pet</h2>
            <div class="header-btns">
                <button class="save-btn" onclick="saveToFile()">üíæ Save</button>
                <button class="exit-btn" onclick="exitGame()">‚ùå Exit</button>
            </div>
        </div>

        <div class="pet-display">
            <img id="petSprite" class="pet-sprite" src="" alt="Pet">
        </div>

        <div class="stats-grid">
            <div class="stat">
                <div class="stat-header">
                    <span>üçó</span>
                    <span>Hunger</span>
                </div>
                <div class="stat-bar">
                    <div id="hungerBar" class="stat-fill high" style="width: 100%"></div>
                </div>
                <div class="stat-value" id="hungerValue">100%</div>
            </div>

            <div class="stat">
                <div class="stat-header">
                    <span>‚ù§Ô∏è</span>
                    <span>Happiness</span>
                </div>
                <div class="stat-bar">
                    <div id="happyBar" class="stat-fill high" style="width: 100%"></div>
                </div>
                <div class="stat-value" id="happyValue">100%</div>
            </div>

            <div class="stat">
                <div class="stat-header">
                    <span>‚ú®</span>
                    <span>Hygiene</span>
                </div>
                <div class="stat-bar">
                    <div id="hygieneBar" class="stat-fill high" style="width: 100%"></div>
                </div>
                <div class="stat-value" id="hygieneValue">100%</div>
            </div>

            <div class="stat">
                <div class="stat-header">
                    <span>üåô</span>
                    <span>Energy</span>
                </div>
                <div class="stat-bar">
                    <div id="energyBar" class="stat-fill high" style="width: 100%"></div>
                </div>
                <div class="stat-value" id="energyValue">100%</div>
            </div>
        </div>

        <div class="age-display">
            Age: <span id="ageDisplay">0</span> minutes old
        </div>

        <div class="actions">
            <button class="action-btn feed" onclick="performAction('feed')">
                <span class="icon">üçó</span>
                <span>Feed</span>
            </button>
            <button class="action-btn play" onclick="performAction('play')">
                <span class="icon">‚ù§Ô∏è</span>
                <span>Play</span>
            </button>
            <button class="action-btn clean" onclick="performAction('clean')">
                <span class="icon">‚ú®</span>
                <span>Clean</span>
            </button>
            <button class="action-btn sleep" onclick="performAction('sleep')">
                <span class="icon">üåô</span>
                <span>Sleep</span>
            </button>
        </div>
    </div>
</div>

<script>
    let gameState = {
        character: null,
        characterName: '',
        characterImage: '',
        stats: {
            hunger: 100,
            happiness: 100,
            hygiene: 100,
            energy: 100,
            age: 0
        },
        lastUpdate: Date.now()
    };

    let updateInterval;

    function selectCharacter(charId, charName, imagePath) {
        gameState.character = charId;
        gameState.characterName = charName;
        gameState.characterImage = imagePath;
        gameState.lastUpdate = Date.now();
        startGame();
    }

    function startGame() {
        document.getElementById('selectScreen').style.display = 'none';
        document.getElementById('gameScreen').style.display = 'block';
        document.getElementById('petName').textContent = gameState.characterName + "'s Pet";
        document.getElementById('petSprite').src = gameState.characterImage;

        updateStats();
        
        if (updateInterval) clearInterval(updateInterval);
        updateInterval = setInterval(decayStats, 1000);
    }

    function decayStats() {
        const now = Date.now();
        const timePassed = (now - gameState.lastUpdate) / 1000;
        
        gameState.stats.hunger = Math.max(0, gameState.stats.hunger - timePassed * 0.5);
        gameState.stats.happiness = Math.max(0, gameState.stats.happiness - timePassed * 0.3);
        gameState.stats.hygiene = Math.max(0, gameState.stats.hygiene - timePassed * 0.2);
        gameState.stats.energy = Math.max(0, gameState.stats.energy - timePassed * 0.4);
        gameState.stats.age += timePassed / 60;
        
        gameState.lastUpdate = now;
        updateStats();
    }

    function updateStats() {
        updateStatDisplay('hunger', gameState.stats.hunger);
        updateStatDisplay('happy', gameState.stats.happiness);
        updateStatDisplay('hygiene', gameState.stats.hygiene);
        updateStatDisplay('energy', gameState.stats.energy);
        document.getElementById('ageDisplay').textContent = Math.floor(gameState.stats.age);
    }

    function updateStatDisplay(stat, value) {
        const bar = document.getElementById(stat + 'Bar');
        const valueEl = document.getElementById(stat + 'Value');
        
        bar.style.width = value + '%';
        valueEl.textContent = Math.round(value) + '%';
        
        bar.className = 'stat-fill';
        if (value > 70) bar.classList.add('high');
        else if (value > 40) bar.classList.add('medium');
        else bar.classList.add('low');
    }

    function performAction(action) {
        const sprite = document.getElementById('petSprite');
        sprite.classList.add('animate');
        setTimeout(() => sprite.classList.remove('animate'), 500);

        const updates = {
            feed: { hunger: Math.min(100, gameState.stats.hunger + 30) },
            play: { happiness: Math.min(100, gameState.stats.happiness + 25) },
            clean: { hygiene: Math.min(100, gameState.stats.hygiene + 35) },
            sleep: { energy: Math.min(100, gameState.stats.energy + 40) }
        };

        Object.assign(gameState.stats, updates[action]);
        updateStats();
    }

    function saveToFile() {
        const saveData = {
            character: gameState.character,
            characterName: gameState.characterName,
            characterImage: gameState.characterImage,
            stats: gameState.stats,
            lastUpdate: Date.now(),
            version: '1.0'
        };

        const blob = new Blob([JSON.stringify(saveData, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = gameState.characterName + '_pet.sps';
        a.click();
        URL.revokeObjectURL(url);
    }

    function loadFromFile(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const data = JSON.parse(e.target.result);
                gameState.character = data.character;
                gameState.characterName = data.characterName;
                gameState.characterImage = data.characterImage;
                gameState.stats = data.stats;
                gameState.lastUpdate = data.lastUpdate;
                startGame();
            } catch (err) {
                alert('Invalid .sps file!');
            }
        };
        reader.readAsText(file);
    }

    function exitGame() {
        if (updateInterval) clearInterval(updateInterval);
        document.getElementById('gameScreen').style.display = 'none';
        document.getElementById('selectScreen').style.display = 'block';
        gameState = {
            character: null,
            characterName: '',
            characterImage: '',
            stats: { hunger: 100, happiness: 100, hygiene: 100, energy: 100, age: 0 },
            lastUpdate: Date.now()
        };
    }
</script>
</body>
</html>